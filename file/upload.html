<!DOCTYPE html>
<html>
<head>
    <title>이미지 업로드 (Supabase)</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script>
        // ✅ Supabase 설정
        const SUPABASE_URL = "https://figegcvlqvikglgrjgeq.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZpZ2VnY3ZscXZpa2dsZ3JqZ2VxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5NDQ0OTAsImV4cCI6MjA1NTUyMDQ5MH0.wvyazV6DQp8Z4baoAuqSSx0Uso8YxWt5_nr89boZBmo"; 
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        async function uploadImage() {
            const fileInput = document.getElementById("fileInput");
            const file = fileInput.files[0];

            if (!file) {
                alert("파일을 선택하세요.");
                return;
            }

            const filePath = `uploads/${file.name}`;
            
            // ✅ Supabase Storage로 업로드
            const { data, error } = await supabase.storage.from('uploads').upload(filePath, file);
            
            if (error) {
                console.error("업로드 실패:", error);
                alert("업로드 실패!");
                return;
            }

            // ✅ 업로드된 파일의 공개 URL 가져오기
            const { data: publicURL } = supabase.storage.from('uploads').getPublicUrl(filePath);
            
            if (publicURL) {
                console.log("업로드된 이미지 URL:", publicURL.publicUrl);
                document.getElementById("uploadedImage").src = publicURL.publicUrl;
                document.getElementById("uploadedImage").style.display = "block";
                alert("업로드 성공! URL: " + publicURL.publicUrl);
            } else {
                alert("URL 가져오기 실패");
            }
        }
    </script>
</head>
<body>
    <h2>Supabase Storage로 이미지 업로드</h2>
    <input type="file" id="fileInput" accept="image/*">
    <button onclick="uploadImage()">업로드</button>
    <h3>업로드된 이미지:</h3>
    <img id="uploadedImage" width="300" style="display: none;">
</body>
</html>
